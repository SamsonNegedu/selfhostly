# =============================================================================
# Selfhostly Configuration
# Copy this file to .env and fill in your values
# =============================================================================

# =============================================================================
# Application Environment
# =============================================================================

# Environment: development, staging, production (default: production)
# Controls debug mode, logging verbosity, and availability of debug endpoints
APP_ENV=production

# Server configuration
# SERVER_ADDRESS=:8080
# DATABASE_PATH=./data/selfhostly.db
# APPS_DIR=./apps

# =============================================================================
# Authentication
# =============================================================================

# RECOMMENDED: Deploy behind Cloudflare Zero Trust and set AUTH_ENABLED=false
# Cloudflare handles authentication at the edge - simpler and more secure!
# See: https://developers.cloudflare.com/cloudflare-one/applications/configure-apps/
AUTH_ENABLED=false

# Alternative: Enable GitHub OAuth with username whitelist
# If you can't use Cloudflare Zero Trust, uncomment and configure below:
# AUTH_ENABLED=true
# JWT_SECRET=your-strong-random-secret-at-least-32-characters-long
# GITHUB_CLIENT_ID=your_github_client_id
# GITHUB_CLIENT_SECRET=your_github_client_secret
# GITHUB_ALLOWED_USERS=your-github-username,other-allowed-username
# NODE_API_ENDPOINT=https://your-domain.com  # REQUIRED for multi-node: This node's reachable URL
# AUTH_SECURE_COOKIE=true

# =============================================================================
# Multi-Node Configuration (optional - for distributed deployments)
# =============================================================================

# Node Identity (auto-generated if not set)
# NODE_ID=auto
# NODE_NAME=primary  # Defaults to hostname if not set

# Primary vs Secondary Node
# Set to false ONLY on secondary nodes
NODE_IS_PRIMARY=true

# Node API Endpoint (for inter-node communication)
# Set this to the reachable URL for this node so other nodes can communicate
# Examples: http://192.168.1.10:8080 or https://node1.example.com
# NODE_API_ENDPOINT=http://192.168.1.10:8080

# -----------------------------------------------------------------------------
# API Key Authentication
# -----------------------------------------------------------------------------

# NODE_API_KEY: This node's own API key
# - Used by OTHER nodes to authenticate when calling THIS node
# - Used by THIS node when sending heartbeats to the primary
# - MUST match the API key entered when registering this node on the primary
# 
# IMPORTANT: Set this explicitly to avoid generating a new key on each restart
# Generate a secure key: openssl rand -base64 32
# NODE_API_KEY=your-generated-secure-api-key-here
#
# Example Setup:
#   1. Generate key: openssl rand -base64 32  → "abc123xyz..."
#   2. Set NODE_API_KEY=abc123xyz... on secondary node's .env
#   3. Register node on primary UI with the SAME API key: abc123xyz...
#   4. Secondary sends heartbeat with this key for authentication ✅

# For Secondary Nodes ONLY:
# URL of the primary node (leave empty for primary node)
# PRIMARY_NODE_URL=http://192.168.1.10:8080

# NOTE: PRIMARY_NODE_API_KEY is currently unused - reserved for future features
# For now, secondary nodes use their own NODE_API_KEY to authenticate to primary
# PRIMARY_NODE_API_KEY=<reserved-for-future-use>

# NOTE: Secondary nodes sync Cloudflare credentials from primary automatically
# Do NOT set CLOUDFLARE_* variables on secondary nodes

# =============================================================================
# Cloudflare (optional - for tunnel management)
# =============================================================================

# Cloudflare API Token (needs Zone:DNS:Edit and Account:Cloudflare Tunnel:Edit)
# PRIMARY NODE ONLY - Secondary nodes sync this automatically
CLOUDFLARE_API_TOKEN=your_cloudflare_api_token

# Cloudflare Account ID (find in Cloudflare dashboard)
# PRIMARY NODE ONLY - Secondary nodes sync this automatically
CLOUDFLARE_ACCOUNT_ID=your_cloudflare_account_id

# Cloudflare Tunnel Token (for the selfhostly tunnel itself)
TUNNEL_TOKEN=your_tunnel_token
